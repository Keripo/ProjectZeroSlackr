diff -r -u -N linux-2.4.24/Makefile linux-2.4.24-sansa/Makefile
--- linux-2.4.24/Makefile	2008-03-26 07:49:20.187500000 +0100
+++ linux-2.4.24-sansa/Makefile	2008-05-29 12:18:12.078125000 +0200
@@ -1,11 +1,11 @@
 VERSION = 2
 PATCHLEVEL = 4
 SUBLEVEL = 24
-EXTRAVERSION = -uc0
+EXTRAVERSION = -sansa2
 
 KERNELRELEASE=$(VERSION).$(PATCHLEVEL).$(SUBLEVEL)$(EXTRAVERSION)
 
-# ARCH := armnommu
+ARCH := armnommu
 # ARCH := m68knommu
 # ARCH := h8300
 # ARCH := niosnommu
@@ -28,7 +28,7 @@
 HOSTCFLAGS	= -Wall -Wstrict-prototypes -O2 -fomit-frame-pointer
 
 # CROSS_COMPILE 	= m68k-elf-
-# CROSS_COMPILE 	= arm-elf-
+CROSS_COMPILE 	= arm-elf-
 # CROSS_COMPILE 	= h8300-elf-
 # CROSS_COMPILE 	= nios-elf-
 # CROSS_COMPILE		= e1-coff-
diff -r -u -N linux-2.4.24/arch/armnommu/Makefile linux-2.4.24-sansa/arch/armnommu/Makefile
--- linux-2.4.24/arch/armnommu/Makefile	2008-03-26 07:49:22.453125000 +0100
+++ linux-2.4.24-sansa/arch/armnommu/Makefile	2008-05-29 12:16:54.500000000 +0200
@@ -249,6 +249,11 @@
 MACHINE         = c5471
 endif
 
+ifeq ($(CONFIG_ARCH_SANSA),y)
+MACHINE		 = sansa
+TEXTADDR	 = 0x00008000
+endif
+
 export	LDFLAGS LIBGCC MACHINE PROCESSOR TEXTADDR GZFLAGS
 
 # Only set INCDIR if its not already defined above
@@ -291,6 +296,11 @@
 		   arch/armnommu/kernel/init_task.o
 endif
 
+ifeq ($(CONFIG_ARCH_SANSA),y)
+HEAD		:= arch/armnommu/kernel/head-arm-sansa.o \
+		   arch/armnommu/kernel/init_task.o
+endif
+
 #
 # If you want the kernel build to build modules outside of the tree
 # then define this and pass it to the main linux makefile
diff -r -u -N linux-2.4.24/arch/armnommu/boot/Makefile linux-2.4.24-sansa/arch/armnommu/boot/Makefile
--- linux-2.4.24/arch/armnommu/boot/Makefile	2008-03-26 07:49:22.500000000 +0100
+++ linux-2.4.24-sansa/arch/armnommu/boot/Makefile	2008-05-29 12:16:53.765625000 +0200
@@ -129,6 +129,13 @@
 
 Image:	$(CONFIGURE) $(SYSTEM)
 	$(OBJCOPY) -O binary -R .note -R .comment -S $(SYSTEM) $@
+ifeq ($(MACH_SANSA),)
+	@mv $@ $@.tmp
+	@$(AS) -o ../mach-sansa/pad.o ../mach-sansa/pad.S
+	@$(OBJCOPY) -O binary ../mach-sansa/pad.o pad.bin
+	@cat pad.bin $@.tmp > $@
+	@$(RM) $@.tmp pad.bin
+endif
 
 bzImage: zImage
 
diff -r -u -N linux-2.4.24/arch/armnommu/config.in linux-2.4.24-sansa/arch/armnommu/config.in
--- linux-2.4.24/arch/armnommu/config.in	2008-03-26 07:49:22.468750000 +0100
+++ linux-2.4.24-sansa/arch/armnommu/config.in	2008-05-29 12:16:53.765625000 +0200
@@ -56,7 +56,8 @@
 	  Triscend-A7V		CONFIG_ARCH_TA7V \
 	  SWARM			CONFIG_ARCH_SWARM \
 	  Samsung		CONFIG_ARCH_SAMSUNG \
-	  Atmel			CONFIG_ARCH_ATMEL" TI-DSC21
+	  Atmel			CONFIG_ARCH_ATMEL \
+	  Sansa			CONFIG_ARCH_SANSA" TI-DSC21
 
 if [ "$CONFIG_ARCH_TA7V" = "y" ]; then
    choice ' Triscend A7V Derivative' \
@@ -477,6 +478,18 @@
    define_hex FLASH_SIZE 0x02000000
 fi
 
+if [ "$CONFIG_ARCH_SANSA" = "y" ]; then
+   define_bool CONFIG_NO_PGT_CACHE y
+   define_bool CONFIG_CPU_ARM710 y
+   define_bool CONFIG_CPU_ARM7TDMI y
+   define_bool CONFIG_CPU_32 y
+   define_bool CONFIG_CPU_26 n
+   define_hex DRAM_BASE 0x00000000
+   define_hex DRAM_SIZE 0x02000000
+   define_hex FLASH_MEM_BASE 0x10000000
+   define_hex FLASH_SIZE 0x00100000
+fi
+
 if [ "$CONFIG_ARCH_TA7S" = "y" -o "$CONFIG_ARCH_TA7V" = "y" ]; then
    define_bool CONFIG_CPU_ARM710 y
    define_bool CONFIG_CPU_ARM7TDMI y
@@ -547,10 +560,12 @@
      "$CONFIG_ARCH_PERSONAL_SERVER" = "y" -o \
      "$CONFIG_ARCH_CATS" = "y" -o \
      "$CONFIG_ARCH_ATMEL" = "y" -o \
+     "$CONFIG_ARCH_ATMEL" = "y" -o \
      "$CONFIG_ARCH_NETARM" = "y" -o \
      "$CONFIG_ARCH_SAMSUNG" = "y" -o \
      "$CONFIG_ARCH_TA7S" = "y" -o \
-     "$CONFIG_ARCH_TA7V" = "y" ]; then
+     "$CONFIG_ARCH_TA7V" = "y" -o \
+     "$CONFIG_ARCH_SANSA" = "y" ]; then
    bool 'Compiled-in Kernel Boot Parameter' CONFIG_CMDLINE_BOOL
    if [ "$CONFIG_CMDLINE_BOOL" = "y" ]; then
       string 'Default kernel command string' CONFIG_CMDLINE ""
@@ -582,6 +597,8 @@
 if [ "$CONFIG_ARCH_INTEGRATOR" = "y" ]; then
    bool 'PCI support' CONFIG_PCI_INTEGRATOR
    define_bool CONFIG_PCI $CONFIG_PCI_INTEGRATOR
+else
+   define_bool CONFIG_PCI n
 fi
 bool 'm68knommu-style attached romfs in RAM support' CONFIG_RAM_ATTACHED_ROMFS
 endmenu
@@ -669,11 +686,23 @@
 source drivers/pnp/Config.in
 source drivers/block/Config.in
 source fs/Config.in
+source drivers/input/Config.in
+
 source drivers/char/Config.in
 source drivers/usb/Config.in
 source drivers/ieee1394/Config.in
 source drivers/message/i2o/Config.in
 
+if [ "$CONFIG_ARCH_SANSA" = "y" ]; then
+   mainmenu_option next_comment
+   comment 'Sansa Stuff'
+   tristate "Sansa Audio" CONFIG_AUDIO_SANSA
+   tristate "Sansa Keypad support" CONFIG_KB_SANSA
+   dep_tristate "Sansa Remote support" CONFIG_REMOTE_SANSA $CONFIG_INPUT_KEYBDEV
+   dep_tristate "Sansa IDE support" CONFIG_IDE_SANSA $CONFIG_BLK_DEV_IDE
+   endmenu
+fi
+
 #------------------------------------------------------------------------------
 #                     K e r n e l    H a c k i n g
 #------------------------------------------------------------------------------
@@ -713,8 +742,9 @@
 	  8192KB	CONFIG_UNCACHED_8192" 1024KB
        fi
      fi
+   else
+     bool 'Allow allocating large blocks (> 1MB) of memory' CONFIG_NO_MMU_LARGE_ALLOCS
    fi
-   dep_bool '  Allow allocating large blocks (> 1MB) of memory' CONFIG_NO_MMU_LARGE_ALLOCS $CONFIG_CONTIGUOUS_PAGE_ALLOC
 fi
 
 endmenu
diff -r -u -N linux-2.4.24/arch/armnommu/kernel/Makefile linux-2.4.24-sansa/arch/armnommu/kernel/Makefile
--- linux-2.4.24/arch/armnommu/kernel/Makefile	2008-03-26 07:49:23.484375000 +0100
+++ linux-2.4.24-sansa/arch/armnommu/kernel/Makefile	2008-05-29 12:16:53.812500000 +0200
@@ -20,6 +20,11 @@
 AFLAGS_head-arm-dsc21.o = -DTEXTADDR=$(TEXTADDR)
 endif
 
+ifeq ($(CONFIG_ARCH_SANSA),y)
+HEAD_OBJ  = head-arm-sansa.o
+AFLAGS_head-arm-sansa.o = -DTEXTADDR=$(TEXTADDR)
+endif
+
 ifeq ($(CONFIG_ARCH_C5471), y)
 HEAD_OBJ  = head-arm-c5471.o
 endif
@@ -56,7 +61,7 @@
 
 no-irq-arch	:= $(CONFIG_ARCH_INTEGRATOR) $(CONFIG_ARCH_CLPS711X) \
 		   $(CONFIG_ARCH_FOOTBRIDGE) $(CONFIG_ARCH_EBSA110) \
-		   $(CONFIG_ARCH_SA1100)
+		   $(CONFIG_ARCH_SA1100) $(CONFIG_ARCH_SANSA)
 
 ifneq ($(findstring y,$(no-irq-arch)),y)
   obj-y		+= irq-arch.o
diff -r -u -N linux-2.4.24/arch/armnommu/kernel/dma.c linux-2.4.24-sansa/arch/armnommu/kernel/dma.c
--- linux-2.4.24/arch/armnommu/kernel/dma.c	2008-03-26 07:49:23.562500000 +0100
+++ linux-2.4.24-sansa/arch/armnommu/kernel/dma.c	2008-05-29 12:16:53.796875000 +0200
@@ -275,6 +275,7 @@
 
 #endif
 
+EXPORT_SYMBOL(free_dma);
 EXPORT_SYMBOL(enable_dma);
 EXPORT_SYMBOL(disable_dma);
 EXPORT_SYMBOL(set_dma_addr);
diff -r -u -N linux-2.4.24/arch/armnommu/kernel/setup.c linux-2.4.24-sansa/arch/armnommu/kernel/setup.c
--- linux-2.4.24/arch/armnommu/kernel/setup.c	2008-03-26 07:49:23.718750000 +0100
+++ linux-2.4.24-sansa/arch/armnommu/kernel/setup.c	2008-05-29 12:16:53.812500000 +0200
@@ -38,7 +38,7 @@
 #endif
 
 #ifndef CONFIG_CMDLINE
-#define CONFIG_CMDLINE "root=/dev/rom0"
+#define CONFIG_CMDLINE "root=/dev/rom0 initrd=/initrd"
 #endif
   
 #ifdef CONFIG_ARCH_NETARM
@@ -94,7 +94,7 @@
 static struct meminfo meminfo __initdata = { 0, };
 static struct proc_info_item proc_info;
 static const char *machine_name;
-static char command_line[COMMAND_LINE_SIZE] = "root=/dev/rom0";
+static char command_line[COMMAND_LINE_SIZE] = "root=/dev/rom0 initrd=/initrd";
 
 static char default_command_line[COMMAND_LINE_SIZE] __initdata = CONFIG_CMDLINE;
 static union { char c[4]; unsigned long l; } endian_test __initdata = { { 'l', '?', '?', 'b' } };
@@ -463,15 +463,20 @@
 	struct tag_core   core;
 	struct tag_header hdr2;
 	struct tag_mem32  mem;
-	struct tag_header hdr3;
+   struct tag_header hdr3;
+   struct tag_ramdisk ird;
+	struct tag_header hdr4;
 } init_tags __initdata = {
 	{ tag_size(tag_core), ATAG_CORE },
 	{ 1, PAGE_SIZE, 0xff },
 	{ tag_size(tag_mem32), ATAG_MEM },
 	{ MEM_SIZE, PHYS_OFFSET },
+   { tag_size(tag_initrd), ATAG_INITRD },
+   { 0x0A00000 , 2097152},
 	{ 0, ATAG_NONE }
 };
 
+
 void __init setup_arch(char **cmdline_p)
 {
 	struct tag *tags = (struct tag *)&init_tags;
diff -r -u -N linux-2.4.24/arch/armnommu/mm/init.c linux-2.4.24-sansa/arch/armnommu/mm/init.c
--- linux-2.4.24/arch/armnommu/mm/init.c	2008-03-26 07:49:24.796875000 +0100
+++ linux-2.4.24-sansa/arch/armnommu/mm/init.c	2008-05-29 12:16:54.500000000 +0200
@@ -391,6 +391,13 @@
 		reserve_bootmem_node(pgdat, 0x02000000, 0x00080000);
 	if (machine_is_p720t())
 		reserve_bootmem_node(pgdat, PAGE_OFFSET, 0x00014000);
+
+	/*
+	 * We reserve the first 32k for the interrupt handlers.  A little
+	 * excessive?  Yes.
+	 */
+	if (machine_is_sansa())
+		reserve_bootmem_node(pgdat, PAGE_OFFSET, 0x00008000);
 }
 
 /*
diff -r -u -N linux-2.4.24/arch/armnommu/tools/mach-types linux-2.4.24-sansa/arch/armnommu/tools/mach-types
--- linux-2.4.24/arch/armnommu/tools/mach-types	2008-03-26 07:49:25.156250000 +0100
+++ linux-2.4.24-sansa/arch/armnommu/tools/mach-types	2008-05-29 12:16:54.578125000 +0200
@@ -111,3 +111,5 @@
 smdk2500		BOARD_SMDK2500		SMDK2500		166
 S3C2500REFRGP		BOARD_S3C2500REFRGP	S3C2500REFRGP		167
 S3C44B0X		BOARD_MBA44		S3C44B0X		168
+
+sansa			ARCH_SANSA		SANSA			280
diff -r -u -N linux-2.4.24/drivers/block/ll_rw_blk.c linux-2.4.24-sansa/drivers/block/ll_rw_blk.c
--- linux-2.4.24/drivers/block/ll_rw_blk.c	2003-11-28 19:26:19.000000000 +0100
+++ linux-2.4.24-sansa/drivers/block/ll_rw_blk.c	2008-05-29 12:17:21.828125000 +0200
@@ -1498,6 +1498,10 @@
 	if (waiting)
 		complete(waiting);
 }
+
+#ifdef CONFIG_ARCH_SANSA
+extern int sd_driver_init(void);
+#endif
 
 int __init blk_dev_init(void)
 {
@@ -1617,6 +1621,10 @@
 
 #ifdef CONFIG_SUN_JSFLASH
 	jsfd_init();
+#endif
+
+#ifdef CONFIG_ARCH_SANSA
+   sd_driver_init();
 #endif
 	return 0;
 };
diff -r -u -N linux-2.4.24/drivers/video/Config.in linux-2.4.24-sansa/drivers/video/Config.in
--- linux-2.4.24/drivers/video/Config.in	2008-03-26 07:49:34.250000000 +0100
+++ linux-2.4.24-sansa/drivers/video/Config.in	2008-05-29 12:17:47.625000000 +0200
@@ -49,6 +49,10 @@
    if [ "$CONFIG_APOLLO" = "y" ]; then
       define_bool CONFIG_FB_APOLLO y
    fi
+   if [ "$CONFIG_ARCH_SANSA" = "y" ]; then
+      tristate '  Sansa LCD support' CONFIG_FB_SANSA
+   fi
+
    if [ "$CONFIG_Q40" = "y" ]; then
       define_bool CONFIG_FB_Q40 y
    fi
diff -r -u -N linux-2.4.24/drivers/video/Makefile linux-2.4.24-sansa/drivers/video/Makefile
--- linux-2.4.24/drivers/video/Makefile	2008-03-26 07:49:34.250000000 +0100
+++ linux-2.4.24-sansa/drivers/video/Makefile	2008-05-29 12:17:48.437500000 +0200
@@ -40,6 +40,7 @@
 obj-$(CONFIG_PPC)                 += macmodes.o
 endif
 
+obj-$(CONFIG_FB_SANSA)             += fbgen.o
 obj-$(CONFIG_FB_ACORN)            += acornfb.o
 obj-$(CONFIG_FB_AMIGA)            += amifb.o
 obj-$(CONFIG_FB_PM2)              += pm2fb.o fbgen.o
diff -r -u -N linux-2.4.24/drivers/video/fbcon.c linux-2.4.24-sansa/drivers/video/fbcon.c
--- linux-2.4.24/drivers/video/fbcon.c	2008-03-26 07:49:34.265625000 +0100
+++ linux-2.4.24-sansa/drivers/video/fbcon.c	2008-05-29 12:17:48.125000000 +0200
@@ -582,8 +582,11 @@
     int i, charcnt = 256;
     struct fbcon_font_desc *font;
     
+/* disable the logo */
+/*
     if (con != fg_console || (p->fb_info->flags & FBINFO_FLAG_MODULE) ||
         p->type == FB_TYPE_TEXT)
+*/
     	logo = 0;
 
     p->var.xoffset = p->var.yoffset = p->yscroll = 0;  /* reset wrap/pan */
diff -r -u -N linux-2.4.24/drivers/video/fbmem.c linux-2.4.24-sansa/drivers/video/fbmem.c
--- linux-2.4.24/drivers/video/fbmem.c	2008-03-26 07:49:34.265625000 +0100
+++ linux-2.4.24-sansa/drivers/video/fbmem.c	2008-05-29 12:17:48.125000000 +0200
@@ -155,6 +155,8 @@
 extern int pvr2fb_setup(char*);
 extern int sstfb_init(void);
 extern int sstfb_setup(char*);
+extern int sansafb_init(void);
+extern int sansafb_setup(char*);
 extern int s3c44b0xfb_init(void);
 extern int s3c44b0xfb_setup(char*);
 #if defined(CONFIG_FB_COBRA5272) && defined(CONFIG_FB_S1D13706)
@@ -180,6 +182,10 @@
 	{ "sbus", sbusfb_init, sbusfb_setup },
 #endif
 
+#ifdef CONFIG_FB_SANSA
+	{ "sansa", sansafb_init, sansafb_setup },
+#endif
+
 	/*
 	 * Chipset specific drivers that use resource management
 	 */
@@ -849,6 +855,7 @@
 
 	if (first) {
 		first = 0;
+#define CONFIG_CONSOLE
 #ifdef CONFIG_CONSOLE
 		take_over_console(&fb_con, first_fb_vc, last_fb_vc, fbcon_is_default);
 #endif
diff -r -u -N linux-2.4.24/fs/partitions/check.c linux-2.4.24-sansa/fs/partitions/check.c
--- linux-2.4.24/fs/partitions/check.c	2008-03-26 07:49:34.562500000 +0100
+++ linux-2.4.24-sansa/fs/partitions/check.c	2008-05-29 12:17:53.578125000 +0200
@@ -124,8 +124,6 @@
 	 * IDE devices use multiple major numbers, but the drives
 	 * are named as:  {hda,hdb}, {hdc,hdd}, {hde,hdf}, {hdg,hdh}..
 	 * This requires special handling here.
-	 *
-	 * MD devices are named md0, md1, ... md15, fix it up here.
 	 */
 	switch (hd->major) {
 		case IDE9_MAJOR:
@@ -209,7 +207,7 @@
 void add_gd_partition(struct gendisk *hd, int minor, int start, int size)
 {
 #ifndef CONFIG_DEVFS_FS
-	char buf[MAX_DISKNAME_LEN];
+	char buf[40];
 #endif
 
 	hd->part[minor].start_sect = start;
@@ -231,7 +229,7 @@
 	static int first_time = 1;
 	unsigned long first_sector;
 	struct block_device *bdev;
-	char buf[MAX_DISKNAME_LEN];
+	char buf[64];
 	int i;
 
 	if (first_time)
diff -r -u -N linux-2.4.24/include/asm-armnommu/mach-types.h linux-2.4.24-sansa/include/asm-armnommu/mach-types.h
--- linux-2.4.24/include/asm-armnommu/mach-types.h	2008-03-26 07:49:35.578125000 +0100
+++ linux-2.4.24-sansa/include/asm-armnommu/mach-types.h	1970-01-01 01:00:00.000000000 +0100
@@ -1,1287 +0,0 @@
-/*
- * This was automagically generated from mach-types!
- * Do NOT edit
- */
-
-#ifndef __ASM_ARM_MACH_TYPE_H
-#define __ASM_ARM_MACH_TYPE_H
-
-#include <linux/config.h>
-
-#ifndef __ASSEMBLY__
-/* The type of machine we're running on */
-extern unsigned int __machine_arch_type;
-#endif
-
-/* see arch/arm/kernel/arch.c for a description of these */
-#define MACH_TYPE_EBSA110              0
-#define MACH_TYPE_RISCPC               1
-#define MACH_TYPE_NEXUSPCI             3
-#define MACH_TYPE_EBSA285              4
-#define MACH_TYPE_NETWINDER            5
-#define MACH_TYPE_CATS                 6
-#define MACH_TYPE_TBOX                 7
-#define MACH_TYPE_CO285                8
-#define MACH_TYPE_CLPS7110             9
-#define MACH_TYPE_ARCHIMEDES           10
-#define MACH_TYPE_A5K                  11
-#define MACH_TYPE_ETOILE               12
-#define MACH_TYPE_LACIE_NAS            13
-#define MACH_TYPE_CLPS7500             14
-#define MACH_TYPE_SHARK                15
-#define MACH_TYPE_BRUTUS               16
-#define MACH_TYPE_PERSONAL_SERVER      17
-#define MACH_TYPE_ITSY                 18
-#define MACH_TYPE_L7200                19
-#define MACH_TYPE_PLEB                 20
-#define MACH_TYPE_INTEGRATOR           21
-#define MACH_TYPE_BITSY                22
-#define MACH_TYPE_IXP1200              23
-#define MACH_TYPE_P720T                24
-#define MACH_TYPE_ASSABET              25
-#define MACH_TYPE_VICTOR               26
-#define MACH_TYPE_LART                 27
-#define MACH_TYPE_RANGER               28
-#define MACH_TYPE_GRAPHICSCLIENT       29
-#define MACH_TYPE_XP860                30
-#define MACH_TYPE_CERF                 31
-#define MACH_TYPE_NANOENGINE           32
-#define MACH_TYPE_FPIC                 33
-#define MACH_TYPE_EXTENEX1             34
-#define MACH_TYPE_SHERMAN              35
-#define MACH_TYPE_ACCELENT_SA          36
-#define MACH_TYPE_ACCELENT_L7200       37
-#define MACH_TYPE_NETPORT              38
-#define MACH_TYPE_PANGOLIN             39
-#define MACH_TYPE_YOPY                 40
-#define MACH_TYPE_COOLIDGE             41
-#define MACH_TYPE_HUW_WEBPANEL         42
-#define MACH_TYPE_SPOTME               43
-#define MACH_TYPE_FREEBIRD             44
-#define MACH_TYPE_TI925                45
-#define MACH_TYPE_RISCSTATION          46
-#define MACH_TYPE_CAVY                 47
-#define MACH_TYPE_JORNADA720           48
-#define MACH_TYPE_OMNIMETER            49
-#define MACH_TYPE_EDB7211              50
-#define MACH_TYPE_CITYGO               51
-#define MACH_TYPE_PFS168               52
-#define MACH_TYPE_SPOT                 53
-#define MACH_TYPE_FLEXANET             54
-#define MACH_TYPE_WEBPAL               55
-#define MACH_TYPE_LINPDA               56
-#define MACH_TYPE_ANAKIN               57
-#define MACH_TYPE_MVI                  58
-#define MACH_TYPE_JUPITER              59
-#define MACH_TYPE_PSIONW               60
-#define MACH_TYPE_ALN                  61
-#define MACH_TYPE_CAMELOT              62
-#define MACH_TYPE_GDS2200              63
-#define MACH_TYPE_PSION_SERIES7        64
-#define MACH_TYPE_XFILE                65
-#define MACH_TYPE_ACCELENT_EP9312      66
-#define MACH_TYPE_IC200                67
-#define MACH_TYPE_CREDITLART           68
-#define MACH_TYPE_HTM                  69
-#define MACH_TYPE_IQ80310              70
-#define MACH_TYPE_FREEBOT              71
-#define MACH_TYPE_ENTEL                72
-#define MACH_TYPE_ENP3510              73
-#define MACH_TYPE_TRIZEPS              74
-#define MACH_TYPE_NESA                 75
-#define MACH_TYPE_VENUS                76
-#define MACH_TYPE_TARDIS               77
-#define MACH_TYPE_MERCURY              78
-#define MACH_TYPE_EMPEG                79
-#define MACH_TYPE_I80200FCC            80
-#define MACH_TYPE_ITT_CPB              81
-#define MACH_TYPE_SA1110_SVC           82
-#define MACH_TYPE_SA1100               83
-#define MACH_TYPE_ALPHA2               84
-#define MACH_TYPE_ALPHA1               85
-#define MACH_TYPE_NETARM               86
-#define MACH_TYPE_DSC21                115
-#define MACH_TYPE_CX821XX              130
-#define MACH_TYPE_ATMEL                224
-#define MACH_TYPE_TA7S                 334
-#define MACH_TYPE_P52                  87
-#define MACH_TYPE_SPIPE                88
-#define MACH_TYPE_SNDS100              90
-#define MACH_TYPE_EVS3C4530HEI         164
-#define MACH_TYPE_S3C3410              165
-#define MACH_TYPE_SMDK2500             166
-#define MACH_TYPE_S3C2500REFRGP        167
-
-#ifdef CONFIG_ARCH_EBSA110
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_EBSA110
-# endif
-# define machine_is_ebsa110()	(machine_arch_type == MACH_TYPE_EBSA110)
-#else
-# define machine_is_ebsa110()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_RPC
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_RISCPC
-# endif
-# define machine_is_riscpc()	(machine_arch_type == MACH_TYPE_RISCPC)
-#else
-# define machine_is_riscpc()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_NEXUSPCI
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_NEXUSPCI
-# endif
-# define machine_is_nexuspci()	(machine_arch_type == MACH_TYPE_NEXUSPCI)
-#else
-# define machine_is_nexuspci()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_EBSA285
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_EBSA285
-# endif
-# define machine_is_ebsa285()	(machine_arch_type == MACH_TYPE_EBSA285)
-#else
-# define machine_is_ebsa285()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_NETWINDER
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_NETWINDER
-# endif
-# define machine_is_netwinder()	(machine_arch_type == MACH_TYPE_NETWINDER)
-#else
-# define machine_is_netwinder()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_CATS
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CATS
-# endif
-# define machine_is_cats()	(machine_arch_type == MACH_TYPE_CATS)
-#else
-# define machine_is_cats()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_TBOX
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_TBOX
-# endif
-# define machine_is_tbox()	(machine_arch_type == MACH_TYPE_TBOX)
-#else
-# define machine_is_tbox()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_CO285
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CO285
-# endif
-# define machine_is_co285()	(machine_arch_type == MACH_TYPE_CO285)
-#else
-# define machine_is_co285()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_CLPS7110
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CLPS7110
-# endif
-# define machine_is_clps7110()	(machine_arch_type == MACH_TYPE_CLPS7110)
-#else
-# define machine_is_clps7110()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_ARC
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ARCHIMEDES
-# endif
-# define machine_is_archimedes()	(machine_arch_type == MACH_TYPE_ARCHIMEDES)
-#else
-# define machine_is_archimedes()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_A5K
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_A5K
-# endif
-# define machine_is_a5k()	(machine_arch_type == MACH_TYPE_A5K)
-#else
-# define machine_is_a5k()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_ETOILE
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ETOILE
-# endif
-# define machine_is_etoile()	(machine_arch_type == MACH_TYPE_ETOILE)
-#else
-# define machine_is_etoile()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_LACIE_NAS
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_LACIE_NAS
-# endif
-# define machine_is_lacie_nas()	(machine_arch_type == MACH_TYPE_LACIE_NAS)
-#else
-# define machine_is_lacie_nas()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_CLPS7500
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CLPS7500
-# endif
-# define machine_is_clps7500()	(machine_arch_type == MACH_TYPE_CLPS7500)
-#else
-# define machine_is_clps7500()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_SHARK
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_SHARK
-# endif
-# define machine_is_shark()	(machine_arch_type == MACH_TYPE_SHARK)
-#else
-# define machine_is_shark()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_BRUTUS
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_BRUTUS
-# endif
-# define machine_is_brutus()	(machine_arch_type == MACH_TYPE_BRUTUS)
-#else
-# define machine_is_brutus()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_PERSONAL_SERVER
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_PERSONAL_SERVER
-# endif
-# define machine_is_personal_server()	(machine_arch_type == MACH_TYPE_PERSONAL_SERVER)
-#else
-# define machine_is_personal_server()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_ITSY
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ITSY
-# endif
-# define machine_is_itsy()	(machine_arch_type == MACH_TYPE_ITSY)
-#else
-# define machine_is_itsy()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_L7200
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_L7200
-# endif
-# define machine_is_l7200()	(machine_arch_type == MACH_TYPE_L7200)
-#else
-# define machine_is_l7200()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_PLEB
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_PLEB
-# endif
-# define machine_is_pleb()	(machine_arch_type == MACH_TYPE_PLEB)
-#else
-# define machine_is_pleb()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_INTEGRATOR
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_INTEGRATOR
-# endif
-# define machine_is_integrator()	(machine_arch_type == MACH_TYPE_INTEGRATOR)
-#else
-# define machine_is_integrator()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_BITSY
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_BITSY
-# endif
-# define machine_is_bitsy()	(machine_arch_type == MACH_TYPE_BITSY)
-#else
-# define machine_is_bitsy()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_IXP1200
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_IXP1200
-# endif
-# define machine_is_ixp1200()	(machine_arch_type == MACH_TYPE_IXP1200)
-#else
-# define machine_is_ixp1200()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_P720T
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_P720T
-# endif
-# define machine_is_p720t()	(machine_arch_type == MACH_TYPE_P720T)
-#else
-# define machine_is_p720t()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_ASSABET
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ASSABET
-# endif
-# define machine_is_assabet()	(machine_arch_type == MACH_TYPE_ASSABET)
-#else
-# define machine_is_assabet()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_VICTOR
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_VICTOR
-# endif
-# define machine_is_victor()	(machine_arch_type == MACH_TYPE_VICTOR)
-#else
-# define machine_is_victor()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_LART
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_LART
-# endif
-# define machine_is_lart()	(machine_arch_type == MACH_TYPE_LART)
-#else
-# define machine_is_lart()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_RANGER
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_RANGER
-# endif
-# define machine_is_ranger()	(machine_arch_type == MACH_TYPE_RANGER)
-#else
-# define machine_is_ranger()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_GRAPHICSCLIENT
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_GRAPHICSCLIENT
-# endif
-# define machine_is_graphicsclient()	(machine_arch_type == MACH_TYPE_GRAPHICSCLIENT)
-#else
-# define machine_is_graphicsclient()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_XP860
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_XP860
-# endif
-# define machine_is_xp860()	(machine_arch_type == MACH_TYPE_XP860)
-#else
-# define machine_is_xp860()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_CERF
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CERF
-# endif
-# define machine_is_cerf()	(machine_arch_type == MACH_TYPE_CERF)
-#else
-# define machine_is_cerf()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_NANOENGINE
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_NANOENGINE
-# endif
-# define machine_is_nanoengine()	(machine_arch_type == MACH_TYPE_NANOENGINE)
-#else
-# define machine_is_nanoengine()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_FPIC
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_FPIC
-# endif
-# define machine_is_fpic()	(machine_arch_type == MACH_TYPE_FPIC)
-#else
-# define machine_is_fpic()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_EXTENEX1
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_EXTENEX1
-# endif
-# define machine_is_extenex1()	(machine_arch_type == MACH_TYPE_EXTENEX1)
-#else
-# define machine_is_extenex1()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_SHERMAN
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_SHERMAN
-# endif
-# define machine_is_sherman()	(machine_arch_type == MACH_TYPE_SHERMAN)
-#else
-# define machine_is_sherman()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_ACCELENT
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ACCELENT_SA
-# endif
-# define machine_is_accelent_sa()	(machine_arch_type == MACH_TYPE_ACCELENT_SA)
-#else
-# define machine_is_accelent_sa()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_L7200_ACCELENT
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ACCELENT_L7200
-# endif
-# define machine_is_accelent_l7200()	(machine_arch_type == MACH_TYPE_ACCELENT_L7200)
-#else
-# define machine_is_accelent_l7200()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_NETPORT
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_NETPORT
-# endif
-# define machine_is_netport()	(machine_arch_type == MACH_TYPE_NETPORT)
-#else
-# define machine_is_netport()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_PANGOLIN
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_PANGOLIN
-# endif
-# define machine_is_pangolin()	(machine_arch_type == MACH_TYPE_PANGOLIN)
-#else
-# define machine_is_pangolin()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_YOPY
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_YOPY
-# endif
-# define machine_is_yopy()	(machine_arch_type == MACH_TYPE_YOPY)
-#else
-# define machine_is_yopy()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_COOLIDGE
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_COOLIDGE
-# endif
-# define machine_is_coolidge()	(machine_arch_type == MACH_TYPE_COOLIDGE)
-#else
-# define machine_is_coolidge()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_HUW_WEBPANEL
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_HUW_WEBPANEL
-# endif
-# define machine_is_huw_webpanel()	(machine_arch_type == MACH_TYPE_HUW_WEBPANEL)
-#else
-# define machine_is_huw_webpanel()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_SPOTME
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_SPOTME
-# endif
-# define machine_is_spotme()	(machine_arch_type == MACH_TYPE_SPOTME)
-#else
-# define machine_is_spotme()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_FREEBIRD
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_FREEBIRD
-# endif
-# define machine_is_freebird()	(machine_arch_type == MACH_TYPE_FREEBIRD)
-#else
-# define machine_is_freebird()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_TI925
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_TI925
-# endif
-# define machine_is_ti925()	(machine_arch_type == MACH_TYPE_TI925)
-#else
-# define machine_is_ti925()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_RISCSTATION
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_RISCSTATION
-# endif
-# define machine_is_riscstation()	(machine_arch_type == MACH_TYPE_RISCSTATION)
-#else
-# define machine_is_riscstation()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_CAVY
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CAVY
-# endif
-# define machine_is_cavy()	(machine_arch_type == MACH_TYPE_CAVY)
-#else
-# define machine_is_cavy()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_JORNADA720
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_JORNADA720
-# endif
-# define machine_is_jornada720()	(machine_arch_type == MACH_TYPE_JORNADA720)
-#else
-# define machine_is_jornada720()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_OMNIMETER
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_OMNIMETER
-# endif
-# define machine_is_omnimeter()	(machine_arch_type == MACH_TYPE_OMNIMETER)
-#else
-# define machine_is_omnimeter()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_EDB7211
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_EDB7211
-# endif
-# define machine_is_edb7211()	(machine_arch_type == MACH_TYPE_EDB7211)
-#else
-# define machine_is_edb7211()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_CITYGO
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CITYGO
-# endif
-# define machine_is_citygo()	(machine_arch_type == MACH_TYPE_CITYGO)
-#else
-# define machine_is_citygo()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_PFS168
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_PFS168
-# endif
-# define machine_is_pfs168()	(machine_arch_type == MACH_TYPE_PFS168)
-#else
-# define machine_is_pfs168()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_SPOT
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_SPOT
-# endif
-# define machine_is_spot()	(machine_arch_type == MACH_TYPE_SPOT)
-#else
-# define machine_is_spot()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_FLEXANET
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_FLEXANET
-# endif
-# define machine_is_flexanet()	(machine_arch_type == MACH_TYPE_FLEXANET)
-#else
-# define machine_is_flexanet()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_WEBPAL
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_WEBPAL
-# endif
-# define machine_is_webpal()	(machine_arch_type == MACH_TYPE_WEBPAL)
-#else
-# define machine_is_webpal()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_LINPDA
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_LINPDA
-# endif
-# define machine_is_linpda()	(machine_arch_type == MACH_TYPE_LINPDA)
-#else
-# define machine_is_linpda()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_ANAKIN
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ANAKIN
-# endif
-# define machine_is_anakin()	(machine_arch_type == MACH_TYPE_ANAKIN)
-#else
-# define machine_is_anakin()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_MVI
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_MVI
-# endif
-# define machine_is_mvi()	(machine_arch_type == MACH_TYPE_MVI)
-#else
-# define machine_is_mvi()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_JUPITER
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_JUPITER
-# endif
-# define machine_is_jupiter()	(machine_arch_type == MACH_TYPE_JUPITER)
-#else
-# define machine_is_jupiter()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_PSIONW
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_PSIONW
-# endif
-# define machine_is_psionw()	(machine_arch_type == MACH_TYPE_PSIONW)
-#else
-# define machine_is_psionw()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_ALN
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ALN
-# endif
-# define machine_is_aln()	(machine_arch_type == MACH_TYPE_ALN)
-#else
-# define machine_is_aln()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_CAMELOT
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CAMELOT
-# endif
-# define machine_is_camelot()	(machine_arch_type == MACH_TYPE_CAMELOT)
-#else
-# define machine_is_camelot()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_GDS2200
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_GDS2200
-# endif
-# define machine_is_gds2200()	(machine_arch_type == MACH_TYPE_GDS2200)
-#else
-# define machine_is_gds2200()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_PSION_SERIES7
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_PSION_SERIES7
-# endif
-# define machine_is_psion_series7()	(machine_arch_type == MACH_TYPE_PSION_SERIES7)
-#else
-# define machine_is_psion_series7()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_XFILE
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_XFILE
-# endif
-# define machine_is_xfile()	(machine_arch_type == MACH_TYPE_XFILE)
-#else
-# define machine_is_xfile()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_ACCELENT_EP9312
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ACCELENT_EP9312
-# endif
-# define machine_is_accelent_ep9312()	(machine_arch_type == MACH_TYPE_ACCELENT_EP9312)
-#else
-# define machine_is_accelent_ep9312()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_IC200
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_IC200
-# endif
-# define machine_is_ic200()	(machine_arch_type == MACH_TYPE_IC200)
-#else
-# define machine_is_ic200()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_CREDITLART
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CREDITLART
-# endif
-# define machine_is_creditlart()	(machine_arch_type == MACH_TYPE_CREDITLART)
-#else
-# define machine_is_creditlart()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_HTM
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_HTM
-# endif
-# define machine_is_htm()	(machine_arch_type == MACH_TYPE_HTM)
-#else
-# define machine_is_htm()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_IQ80310
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_IQ80310
-# endif
-# define machine_is_iq80310()	(machine_arch_type == MACH_TYPE_IQ80310)
-#else
-# define machine_is_iq80310()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_FREEBOT
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_FREEBOT
-# endif
-# define machine_is_freebot()	(machine_arch_type == MACH_TYPE_FREEBOT)
-#else
-# define machine_is_freebot()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_ENTEL
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ENTEL
-# endif
-# define machine_is_entel()	(machine_arch_type == MACH_TYPE_ENTEL)
-#else
-# define machine_is_entel()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_ENP3510
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ENP3510
-# endif
-# define machine_is_enp3510()	(machine_arch_type == MACH_TYPE_ENP3510)
-#else
-# define machine_is_enp3510()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_TRIZEPS
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_TRIZEPS
-# endif
-# define machine_is_trizeps()	(machine_arch_type == MACH_TYPE_TRIZEPS)
-#else
-# define machine_is_trizeps()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_NESA
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_NESA
-# endif
-# define machine_is_nesa()	(machine_arch_type == MACH_TYPE_NESA)
-#else
-# define machine_is_nesa()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_VENUS
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_VENUS
-# endif
-# define machine_is_venus()	(machine_arch_type == MACH_TYPE_VENUS)
-#else
-# define machine_is_venus()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_TARDIS
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_TARDIS
-# endif
-# define machine_is_tardis()	(machine_arch_type == MACH_TYPE_TARDIS)
-#else
-# define machine_is_tardis()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_MERCURY
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_MERCURY
-# endif
-# define machine_is_mercury()	(machine_arch_type == MACH_TYPE_MERCURY)
-#else
-# define machine_is_mercury()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_EMPEG
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_EMPEG
-# endif
-# define machine_is_empeg()	(machine_arch_type == MACH_TYPE_EMPEG)
-#else
-# define machine_is_empeg()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_I80200FCC
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_I80200FCC
-# endif
-# define machine_is_i80200fcc()	(machine_arch_type == MACH_TYPE_I80200FCC)
-#else
-# define machine_is_i80200fcc()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_ITT_CPB
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ITT_CPB
-# endif
-# define machine_is_itt_cpb()	(machine_arch_type == MACH_TYPE_ITT_CPB)
-#else
-# define machine_is_itt_cpb()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_SA1110_SVC
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_SA1110_SVC
-# endif
-# define machine_is_sa1110_svc()	(machine_arch_type == MACH_TYPE_SA1110_SVC)
-#else
-# define machine_is_sa1110_svc()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_SA1100
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_SA1100
-# endif
-# define machine_is_sa1100()	(machine_arch_type == MACH_TYPE_SA1100)
-#else
-# define machine_is_sa1100()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_ALPHA2
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ALPHA2
-# endif
-# define machine_is_alpha2()	(machine_arch_type == MACH_TYPE_ALPHA2)
-#else
-# define machine_is_alpha2()	(0)
-#endif
-
-#ifdef CONFIG_SA1100_ALPHA1
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ALPHA1
-# endif
-# define machine_is_alpha1()	(machine_arch_type == MACH_TYPE_ALPHA1)
-#else
-# define machine_is_alpha1()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_NETARM
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_NETARM
-# endif
-# define machine_is_netarm()	(machine_arch_type == MACH_TYPE_NETARM)
-#else
-# define machine_is_netarm()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_DSC21
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_DSC21
-# endif
-# define machine_is_dsc21()	(machine_arch_type == MACH_TYPE_DSC21)
-#else
-# define machine_is_dsc21()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_CX821XX
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_CX821XX
-# endif
-# define machine_is_cx821xx()	(machine_arch_type == MACH_TYPE_CX821XX)
-#else
-# define machine_is_cx821xx()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_ATMEL
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_ATMEL
-# endif
-# define machine_is_atmel()	(machine_arch_type == MACH_TYPE_ATMEL)
-#else
-# define machine_is_atmel()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_TA7S
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_TA7S
-# endif
-# define machine_is_ta7s()	(machine_arch_type == MACH_TYPE_TA7S)
-#else
-# define machine_is_ta7s()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_P52
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_P52
-# endif
-# define machine_is_p52()	(machine_arch_type == MACH_TYPE_P52)
-#else
-# define machine_is_p52()	(0)
-#endif
-
-#ifdef CONFIG_ARCH_SPIPE
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_SPIPE
-# endif
-# define machine_is_spipe()	(machine_arch_type == MACH_TYPE_SPIPE)
-#else
-# define machine_is_spipe()	(0)
-#endif
-
-#ifdef CONFIG_BOARD_SNDS100
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_SNDS100
-# endif
-# define machine_is_snds100()	(machine_arch_type == MACH_TYPE_SNDS100)
-#else
-# define machine_is_snds100()	(0)
-#endif
-
-#ifdef CONFIG_BOARD_EVS3C4530HEI
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_EVS3C4530HEI
-# endif
-# define machine_is_evS3C4530HEI()	(machine_arch_type == MACH_TYPE_EVS3C4530HEI)
-#else
-# define machine_is_evS3C4530HEI()	(0)
-#endif
-
-#ifdef CONFIG_BOARD_SMDK40100
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_S3C3410
-# endif
-# define machine_is_S3C3410X()	(machine_arch_type == MACH_TYPE_S3C3410)
-#else
-# define machine_is_S3C3410X()	(0)
-#endif
-
-#ifdef CONFIG_BOARD_SMDK2500
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_SMDK2500
-# endif
-# define machine_is_smdk2500()	(machine_arch_type == MACH_TYPE_SMDK2500)
-#else
-# define machine_is_smdk2500()	(0)
-#endif
-
-#ifdef CONFIG_BOARD_S3C2500REFRGP
-# ifdef machine_arch_type
-#  undef machine_arch_type
-#  define machine_arch_type	__machine_arch_type
-# else
-#  define machine_arch_type	MACH_TYPE_S3C2500REFRGP
-# endif
-# define machine_is_S3C2500REFRGP()	(machine_arch_type == MACH_TYPE_S3C2500REFRGP)
-#else
-# define machine_is_S3C2500REFRGP()	(0)
-#endif
-
-/*
- * These have not yet been registered
- */
-
-#ifndef machine_arch_type
-#define machine_arch_type	__machine_arch_type
-#endif
-
-#endif
diff -r -u -N linux-2.4.24/include/asm-armnommu/pci.h linux-2.4.24-sansa/include/asm-armnommu/pci.h
--- linux-2.4.24/include/asm-armnommu/pci.h	2008-03-26 07:49:35.703125000 +0100
+++ linux-2.4.24-sansa/include/asm-armnommu/pci.h	2008-05-29 12:17:57.968750000 +0200
@@ -78,6 +78,17 @@
 	/* nothing to do */
 }
 
+static inline dma_addr_t pci_map_page(struct pci_dev *hwdev, struct page *page,
+                                      unsigned long offset, size_t size, int direction)
+{
+	return pci_map_single(hwdev, page_address(page) + offset, size, direction);
+}
+
+static inline void pci_unmap_page(struct pci_dev *hwdev, dma_addr_t dma_address,                                  size_t size, int direction)
+{
+	/* Nothing to do */
+}
+
 /* Map a set of buffers described by scatterlist in streaming
  * mode for DMA.  This is the scather-gather version of the
  * above pci_map_single interface.  Here the scatter gather list
@@ -99,13 +110,21 @@
 	int i;
 
 	for (i = 0; i < nents; i++, sg++) {
-		consistent_sync(sg->address, sg->length, direction);
-		sg->dma_address = virt_to_bus(sg->address);
+ 		if (sg->address) {
+			consistent_sync(sg->address, sg->length, direction);
+			sg->dma_address = virt_to_bus(sg->address);
+		}
+		else {
+/* bus & phys are the same */
+#define page_to_bus page_to_phys
+
+			consistent_sync(page_address(sg->page) + sg->offset, sg->length, direction);
+			sg->dma_address = page_to_bus(sg->page) + sg->offset;
+		}
 	}
 
 	return nents;
-}
-
+} 
 /* Unmap a set of streaming mode DMA translations.
  * Again, cpu read rules concerning calls here are the same as for
  * pci_unmap_single() above.
@@ -143,7 +162,12 @@
 	int i;
 
 	for (i = 0; i < nelems; i++, sg++)
-		consistent_sync(sg->address, sg->length, direction);
+		if (sg->address) {
+			consistent_sync(sg->address, sg->length, direction);
+		}
+		else {
+			consistent_sync(page_address(sg->page) + sg->offset, sg->length, direction);
+		}
 }
 
 /* Return whether the given PCI device DMA address mask can
diff -r -u -N linux-2.4.24/include/asm-armnommu/scatterlist.h linux-2.4.24-sansa/include/asm-armnommu/scatterlist.h
--- linux-2.4.24/include/asm-armnommu/scatterlist.h	2008-03-26 07:49:35.750000000 +0100
+++ linux-2.4.24-sansa/include/asm-armnommu/scatterlist.h	2008-05-29 12:17:58.000000000 +0200
@@ -5,6 +5,9 @@
 
 struct scatterlist {
 	char		*address;	/* virtual address		 */
+	struct page	*page;		/* Location for highmem page, if any */
+	unsigned int	offset;
+
 	char		*alt_address;	/* indirect dma address, or NULL */
 	dma_addr_t	dma_address;	/* dma address			 */
 	unsigned int	length;		/* length			 */
diff -r -u -N linux-2.4.24/include/asm-armnommu/types.h linux-2.4.24-sansa/include/asm-armnommu/types.h
--- linux-2.4.24/include/asm-armnommu/types.h	2008-03-26 07:49:35.843750000 +0100
+++ linux-2.4.24-sansa/include/asm-armnommu/types.h	2008-05-29 12:17:58.015625000 +0200
@@ -44,6 +44,7 @@
 /* Dma addresses are 32-bits wide.  */
 
 typedef u32 dma_addr_t;
+typedef u32 dma64_addr_t;
 
 #endif /* __KERNEL__ */
 
diff -r -u -N linux-2.4.24/include/linux/serio.h linux-2.4.24-sansa/include/linux/serio.h
--- linux-2.4.24/include/linux/serio.h	2002-11-29 00:53:15.000000000 +0100
+++ linux-2.4.24-sansa/include/linux/serio.h	2008-05-29 12:18:09.468750000 +0200
@@ -110,6 +110,7 @@
 #define SERIO_H3600	0x21
 #define SERIO_PS2SER	0x22
 #define SERIO_HIL	0x25
+#define SERIO_SANSA_REM	0x26
 
 #define SERIO_ID	0xff00UL
 #define SERIO_EXTRA	0xff0000UL
diff -r -u -N linux-2.4.24/kernel/Makefile linux-2.4.24-sansa/kernel/Makefile
--- linux-2.4.24/kernel/Makefile	2008-03-26 07:49:42.187500000 +0100
+++ linux-2.4.24-sansa/kernel/Makefile	2008-05-29 12:18:10.750000000 +0200
@@ -9,7 +9,7 @@
 
 O_TARGET := kernel.o
 
-export-objs = signal.o sys.o kmod.o context.o ksyms.o pm.o exec_domain.o printk.o dma.o
+export-objs = signal.o sys.o kmod.o context.o ksyms.o pm.o exec_domain.o printk.o
 
 obj-y     = sched.o fork.o exec_domain.o panic.o printk.o \
 	    module.o exit.o itimer.o info.o time.o softirq.o resource.o \
@@ -17,6 +17,7 @@
 	    signal.o sys.o kmod.o context.o
 
 ifndef CONFIG_ARM
+export-objs += dma.o
 obj-y	 += dma.o
 endif
 
Dateien linux-2.4.24/scripts/mkdep.exe und linux-2.4.24-sansa/scripts/mkdep.exe sind verschieden.
Dateien linux-2.4.24/scripts/split-include.exe und linux-2.4.24-sansa/scripts/split-include.exe sind verschieden.
